params {
    adapter_trimming = true
    getBAM = false
    genome = "/path/to/reference_genome"
    gtf = "/path/to/gtf_file"
    outDir = "results"
    sampleDir = "/path/to/samples/dir"
    adapters = "/path/to/trimmomatic/adapters_file"
    transcriptome = "/path/to/transcriptome_file"

    trimmomatic_threads = 10
    fastQC_threads = 10
    index_building_threads = 4
    star_threads = 3
    samtools_threads = 7
    rsem_threads = 10
    salmon_index_threads = 4
    salmon_quant_threads = 8
}

process {
    executor = 'slurm'

    withName: build_salmon_index {
        queue = "express"
        memory = "8.GB"
        cpus = params.salmon_index_threads
        time = "1.h"
    }

    withName: infer_strandness {
        queue = "batch"
        memory = "16.GB"
        cpus = params.salmon_quant_threads
        time = "6.h"
    }

    withName: merge_strandness_results {
        queue = "express"
        memory = "1.GB"
        cpus = 1
        time = "1.h"
    }

    withName: adapters_trimming {
        queue = "express"
        memory = "2.GB"
        cpus = params.trimmomatic_threads
        time = "1.h"
    }

    withName: fastQC_post_trimming {
        queue = "express"
        cpus =  params.fastQC_threads
        time =  "2.h"
        errorStrategy = "retry"
        maxRetries = 5
    }

    withName: fastQC_raw_data {
        queue = "express"
        cpus =  params.fastQC_threads
        time =  "2.h"
        errorStrategy = "retry"
        maxRetries = 5
    }

    withName: multiQC_raw_data {
        queue = "express"
        time =  "2.h"
    }

    withName: star_and_RSEM_index_building {
        queue = "batch"
        cpus = params.index_building_threads
        time = "8.h"
        memory = "50.GB"
    }

    withName: star_alignment {
        queue = "long"
        memory = "58.GB"
        cpus = params.star_threads
        time = "2 days 20 hours"
    }

    withName: samtools_sort_by_coordinates {
        queue = "batch"
        memory = "30.GB"
        cpus = params.samtools_threads
        time = "23.h"
    }

    withName: get_bam_files {
        queue = "express"
        time =  "2.h"
    }

    withName: collapsed_gtf {
        queue = "express"
        time = "1.h"
        memory = "15.GB"
    }

    withName: qc_post_alignment {
        queue = "express"
        time = "2.h"
    }

    withName: rsem_transcript_quantification {
        queue = "batch"
        memory = "30.GB"
        cpus = params.rsem_threads
        time = "4.h"
    }
}

apptainer {
    enabled = true
}

profiles {
    slurm {
        process.executor = 'slurm'
    }
}